import os
import numpy as np
import cv2
import glob
import matplotlib.pyplot as plt
import seaborn as sns
import time
from pathlib import Path
import math


# kentai = ['hansyaban']

"""remove wavelength"""
#削除したい波長
rem_wave =[652,658,664,670,676,682,688,694,700,706,712,718,724,730,736,742,748,754,760,766,772,778,784,
              790,796,802,808,814,820,826,832,838,844,850,856,862,868,874,880,886,892,898,904
              ] 

wave_length = [652,658,664,670,676,682,688,694,700,706,712,718,724,730,736,742,748,754,760,766,772,778,784,
              790,796,802,808,814,820,826,832,838,844,850,856,862,868,874,880,886,892,898,904,910,916,922,928,934,940,946,952,958,964,
              970,976,982,988,994,1000,1006,1012,1018,1024,1030,1036,1042,1048,1054,1060,1066,1072,1078,1084,1090,1096,1102,1108,1114,
              1120,1126,1132,1138,1144,1150,1156,1162,1168,1174,1180,1186,1192,1198,1204,1210,1216,1222,1228,1234,1240,1246,1252,1258,
              1264,1270,1276,1282,1288,1294,1300,1306,1312,1318,1324,1330,1336,1342,1348,1354,1360,1366,1372,1378,1384,1390,1396,1402,
              1408,1414,1420,1426,1432,1438,1444,1450,1456,1462,1468,1474,1480,1486,1492,1498,1504,1510,1516,1522,1528,1534,1540,1546,
              1552,1558,1564,1570,1576,1582,1588,1594,1600]
del_wave_length = wave_length.copy()
for rem in rem_wave:
    #print(rem)
    del_wave_length.remove(rem)
print(del_wave_length)
total_l = len(wave_length)
l = len(wave_length) - len(rem_wave)


def main():   
            # for wl in del_wave_length:
            #     print('=====')
            #     print(wl)
            img = cv2.imread(r'20230901_fiber\label2\2\top100\{}.png'.format(910), flags=cv2.IMREAD_GRAYSCALE)  #2
            # img = cv2.imread(r'20230901_fiber\label2\4\top100\{}.png'.format(1426), flags=cv2.IMREAD_GRAYSCALE)  #4
            # img = cv2.imread(r'20230901_fiber\label2\6\top100\{}.png'.format(910), flags=cv2.IMREAD_GRAYSCALE)  #6
            # img = cv2.imread(r'20230901_fiber\label2\7\top100\{}.png'.format(910), flags=cv2.IMREAD_GRAYSCALE)  #7
            # img = cv2.imread(r'20230901_fiber\label2\9\top100\{}.png'.format(1534), flags=cv2.IMREAD_GRAYSCALE)  #9
            # img = cv2.imread(r'20230901_fiber\label2\11\top100\{}.png'.format(1414), flags=cv2.IMREAD_GRAYSCALE)  #11
            # img = cv2.imread(r'20230901_fiber\label2\14\top100\{}.png'.format(1210), flags=cv2.IMREAD_GRAYSCALE)  #14
            zero = img.copy()
            zero[:,:] = 0

            plt.imshow(img)
            plt.show()

            #zyushi
            #2
            # mask_poly1 = np.array([[578,212],[534,284],[534,300],[519,316],[551,344],[605,380],[628,367],[670,333],[697,281],[702,236],[660,213],[639,209],[605,193]])
            # mask_poly2 = np.array([[392,620],[389,645],[411,681],[410,731],[441,764],[501,774],[524,763],[533,720],[524,686],[534,616],[514,604],[475,603],[473,606]])             
            # mask_poly3 = np.array([[722,632],[728,656],[723,688],[739,733],[801,745],[881,719],[889,666],[866,609],[847,601],[767,595],[738,611]])
            #4
            # mask_poly1 = np.array([[501,333],[539,390],[535,446],[578,451],[671,412],[664,365],[637,301],[561,309],[535,326]])
            # mask_poly2 = np.array([[417,708],[454,758],[456,789],[544,757],[548,730],[510,669],[433,681]])             
            # mask_poly3 = np.array([[728,650],[751,709],[762,753],[812,766],[882,732],[859,705],[831,631],[767,634]])
            #6
            # mask_poly1 = np.array([[542,273],[554,296],[553,323],[565,333],[567,375],[581,384],[607,397],[700,362],[691,318],[679,263],[660,229],[625,231],[553,248]])
            # mask_poly2 = np.array([[418,575],[417,601],[450,645],[518,698],[558,681],[574,675],[587,650],[571,630],[573,606],[537,532],[516,522],[443,560]])             
            # mask_poly3 = np.array([[749,591],[763,644],[784,701],[821,708],[856,672],[860,649],[845,562],[830,556],[785,558],[781,559],[760,567]])
            #7
            # mask_poly1 = np.array([[566,228],[545,272],[565,329],[564,351],[576,408],[619,412],[735,386],[727,324],[703,237],[674,220]])
            # mask_poly2 = np.array([[435,588],[447,641],[486,742],[508,754],[605,731],[608,655],[586,543],[570,539],[532,554],[475,564]])             
            # mask_poly3 = np.array([[790,543],[759,570],[764,643],[778,683],[814,688],[870,670],[909,674],[928,634],[928,534],[917,522],[855,563],[810,542]])
            #9
            # mask_poly1 = np.array([[577,247],[566,276],[582,344],[572,403],[585,408],[650,377],[676,389],[731,370],[730,301],[696,231],[653,248]])
            # mask_poly2 = np.array([[401,593],[398,607],[428,672],[442,739],[455,748],[569,732],[582,684],[541,578],[518,561],[476,561]])             
            # mask_poly3 = np.array([[743,569],[715,619],[775,734],[807,744],[889,708],[909,672],[930,638],[912,554],[883,522],[825,562]])
            #11
            # mask_poly1 = np.array([[553,247],[543,273],[544,364],[573,380],[622,372],[649,359],[673,329],[665,234],[655,230],[619,245]])
            # mask_poly2 = np.array([[405,482],[402,498],[419,578],[460,608],[526,578],[528,543],[511,474],[484,459],[446,472]])             
            # mask_poly3 = np.array([[759,456],[749,494],[710,505],[684,508],[679,536],[704,565],[706,600],[718,622],[731,618],[762,596],[821,587],[825,571],[822,532],[807,472],[804,446]])
            #14
            # mask_poly1 = np.array([[478,233],[473,244],[462,295],[469,323],[493,332],[513,320],[560,325],[589,329],[622,314],[630,252],[609,228]])
            # mask_poly2 = np.array([[376,531],[384,568],[419,603],[432,634],[456,647],[490,650],[535,632],[509,557],[511,518],[485,499],[429,511]])             
            # mask_poly3 = np.array([[757,474],[743,504],[754,540],[738,575],[753,602],[826,626],[851,612],[860,555],[871,503],[843,485],[793,483]])

            #mawari
            #2
            mask_poly1 = np.array([[603,147],[561,177],[537,221],[463,321],[493,356],[615,435],[707,360],[775,240],[696,171],[628,149]])
            mask_poly2 = np.array([[344,588],[329,643],[343,707],[368,797],[473,825],[582,780],[589,690],[566,576],[449,556]])             
            mask_poly3 = np.array([[699,565],[670,634],[668,695],[691,775],[755,797],[864,788],[926,747],[943,658],[917,554],[829,550]])
            #4
            #6
            #7
            #9
            #11
            #14



            img_mask = cv2.fillPoly(img, [mask_poly1], 255)
            img_mask = cv2.fillPoly(img_mask, [mask_poly2], 255)
            img_mask = cv2.fillPoly(img_mask, [mask_poly3], 255)
            mask = cv2.fillPoly(zero, [mask_poly1], 255)
            mask = cv2.fillPoly(zero, [mask_poly2], 255)
            mask = cv2.fillPoly(mask, [mask_poly3], 255)

            cv2.imwrite(r'20230901_fiber\mask\2\{}.png'.format(2002), img_mask)
            cv2.imwrite(r'20230901_fiber\mask\2\{}.png'.format(2003), mask)
        

"""3. execution"""
if __name__ == "__main__":
    before_time = time.ctime()
    before_cnvtime = time.strptime(before_time)
    
    main()
    
    after_time = time.ctime()
    after_cnvtime = time.strptime(after_time)
    
    print("start time : ", time.strftime("%Y/%m/%d %H:%M:%S", before_cnvtime))
    print("finish time : ", time.strftime("%Y/%m/%d %H:%M:%S", after_cnvtime))